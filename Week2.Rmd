---
title: "Week2: Exploratory Data Analysis"
output:
  html_document: 
    toc: yes
    toc_float: yes
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  message=FALSE, 
  warning=FALSE,
  comment = "#>"
)
```

## Load required packages

```{r}
library(magrittr)
library(dplyr)
library(readr)
```

## Assignment for Week 1

1. Check this video: https://www.youtube.com/watch?v=0xVqLJe9_CY&feature=youtu.be
2. Load the [Pokemon data](data/pokemons.csv) into `data.frame`
3. Find the heaviest one of 151 pokemons
4. How many pokemons of which `Type1` are `"FIRE"`
5. Find the pokemon of which `Type1` are `"POISON"` and has the largest `BaseAttack` value

```{r, eval=TRUE, collapse=FALSE}
library(dplyr)
library(readr)

# Read data
pokemon <- read_csv("data/pokemons.csv")
print(pokemon)

# Find the heaviest one of 151 pokemons
pokemon %>% arrange(desc(PokedexWeightKg)) %>% head(3)

# How many pokemons of which Type1 are "FIRE"
pokemon %>% filter(Type1 == "FIRE")

# Find the pokemon of which Type1 are "POISON" and has the largest BaseAttack value
pokemon %>% 
  select(Identifier, Type1, BaseAttack) %>% # select columns
  filter(Type1 == "POISON") %>% # filter Type1
  arrange(desc(BaseAttack)) %>%  # arrange the order by BaseAttack
  head(5)
```

## Dive in one variable

### Select a variable in data.frame

```{r}
# pokemon$<variable>
pokemon$Type1
pokemon$BaseDefense
```

### Counting

```{r}
pokemon$Type1 %>%  # $: selecting variable
  table
```

## Plotting in R

### Graphic is more intutive

```{r}
par(family="STHeiti") # 顯示中文字體 Mac user only

pokemon$Type1 %>% 
  table %>% 
  sort(decreasing = F) %>% 
  barplot(las=1, horiz=TRUE)

pokemon$Type1 %>% 
  table %>% 
  sort(decreasing = T) %>% 
  pie(clockwise = T)
```

**Try:**

- Show the `CandyFamily` pie plot

### Histogram

```{r}
# The distribution of Pokemons' Weight
pokemon$PokedexWeightKg %>% 
  hist

# More setting
pokemon$PokedexWeightKg %>% 
  hist(breaks = 20, # number of bins
       col = "lightblue",
       prob = TRUE, # 顯示機率分佈
       xlab = "Pokemon Weight",
       main = "Historgram")
```

**Try:**

- Show the distribution of `BaseCaptureRate` by histogram

### Boxplots

```{r}
boxplot(pokemon$BaseCaptureRate,
        main='Base Capture Rate',
        xlab='Capture Rate')

# Multiple variables
boxplot(BaseCaptureRate ~ Type1,
        data = pokemon,
        main='Base Capture Rate',
        xlab='Type',
        las=2)
```

**Try:**

- Plot a scatter plot to find the relationship between `PokedexHeightM` and `PokedexWeightKg`

### Scatter Plots

```{r}
plot(pokemon$BaseAttack, pokemon$BaseDefense,
     main = "Attack vs. Defense")

# Add regression line
abline(lm(BaseAttack ~ BaseDefense, data = pokemon), col="red")
```

## Compute statistics

### Basic Numerical Descriptions

The following commands can be used to get the mean, median, quantiles, minimum, maximum, variance, and standard deviation of a set of numbers:

```{r}
pokemon$BaseCaptureRate

mean(pokemon$BaseCaptureRate) # 平均數
median(pokemon$BaseCaptureRate) # 中位數
quantile(pokemon$BaseCaptureRate) # 四分位數
min(pokemon$BaseCaptureRate) # 最小值
max(pokemon$BaseCaptureRate) # 最大值
var(pokemon$BaseCaptureRate) # 變異數
sd(pokemon$BaseCaptureRate) # 標準差
cor(pokemon$BaseCaptureRate, pokemon$BaseAttack) # 相關係數
summary(pokemon$BaseCaptureRate) # 基本敘述統計
summary(pokemon)
```


**Try:**

- Find the largest value of `BaseDefense`

## Introduction to Programming

### Equality

The most basic form of comparison is equality. Let's briefly recap its syntax. The following statements all evaluate to TRUE (feel free to try them out in the console).

```{r, eval=FALSE}
3 == (2 + 1)
"intermediate" != "r"
TRUE != FALSE
"Rchitect" != "rchitect"
```

**Try:**

- In the editor on the right, write R code to see if `TRUE` equals `FALSE`.
- Likewise, check if `-6 * 14` is not equal to `17 - 101`.
- Next up: comparison of character strings. Ask R whether the strings `"useR"` and `"user"` are equal.
- Finally, find out what happens if you compare logicals to numerics: are `TRUE` and `1` equal?

```{r, eval=FALSE}
# Comparison of logicals


# Comparison of numerics


# Comparison of character strings


# Compare a logical with a numeric

```

### Greater and less than

Apart from equality operators, Filip also introduced the less than and greater than operators: < and >. You can also add an equal sign to express less than or equal to or greater than or equal to, respectively. Have a look at the following R expressions, that all evaluate to FALSE:

```{r, eval=FALSE}
(1 + 2) > 4
"dog" < "Cats"
TRUE <= FALSE
```

**Try:**

- `-6 * 5 + 2` is greater than or equal to `-10 + 1`.
- `"raining"` is less than or equal to `"raining dogs"`.
- `TRUE` is greater than `FALSE`.

### Compare vectors

```{r, eval=FALSE}
# The linkedin and facebook vectors have already been created for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
facebook <- c(17, 7, 5, 16, 8, 13, 14)

# Popular days: On which days did the number of LinkedIn profile views exceed 15?


# Quiet days: When was your LinkedIn profile viewed only 5 times or fewer?


# LinkedIn more popular than Facebook:
# When was your LinkedIn profile visited more often than your Facebook profile?


```

### Logical Operators: & and |

真值表：

![](http://www.offcn.com/dl/2015/0522/20150522094623812.jpg)

```{r}
TRUE & TRUE
FALSE | TRUE
5 <= 5 & 2 < 3
3 < 4 | 7 < 6
```

> Watch out: 3 < x < 7 to check if x is between 3 and 7 will not work; you'll need 3 < x & x < 7 for that.

**Try:**

```{r, eval=FALSE}
# The linkedin and last variable are already defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
last <- tail(linkedin, 1)

# Is last under 5 or above 10?


# Is last between 15 (exclusive) and 20 (inclusive)?

```

### The if statement

```{r, eval=FALSE}
if (condition) {
  expr
}
```

```{r}
# Variables related to your last day of recordings
medium <- "LinkedIn"
num_views <- 14

# Examine the if statement for medium: Examine the if statement that prints out "Showing LinkedIn information" if the medium variable equals "LinkedIn".
if (medium == "LinkedIn") {
  print("Showing LinkedIn information")
}

# Write the if statement for num_views: Code an if statement that prints "You're popular!" to the console if the num_views variable exceeds 15.



```


## Assignment

Load the `pokemon` dataset by 

```{r, eval=F}
library(dplyr)
pokemon <- readr::read_csv("https://github.com/leoluyi/R-basic-tutorial-201708/raw/gh-pages/data/pokemons.csv")
```

1. Plot the scatter plot of variables: `PokedexHeightM` and `PokedexWeightKg`. Is there any positive or negative relationship between those variables? What's the coorelation coeficient?
2. Show the rows of `pokemon` data.frame of condition: `BaseAttack` is greater than `BaseStamina`. (Hint: use `filter()` in `dplyr`)
3. Write an `if` statement for `pokemon$BaseAttack`: Code an if statement that prints "Mean BaseAttack is greater than 150!" to the console if the mean of `BaseAttack` variable exceeds 150.

